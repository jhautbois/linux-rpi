# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/media/brcm,bcm2835-unicam.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Broadcom BCM283x Camera Interface (Unicam)

maintainers:
  - Dave Stevenson <dave.stevenson@raspberrypi.com>

description: |-
  The Unicam block on BCM283x SoCs is the receiver for either
  CSI-2 or CCP2 data from image sensors or similar devices.

  The main platform using this SoC is the Raspberry Pi family of boards.
  On the Pi the VideoCore firmware can also control this hardware block,
  and driving it from two different processors will cause issues.
  To avoid this, the firmware checks the device tree configuration
  during boot. If it finds device tree nodes called csi0 or csi1 then
  it will stop the firmware accessing the block, and it can then
  safely be used via the device tree binding.

properties:
  compatible:
    const: brcm,bcm2835-unicam

  reg:
    description:
      physical base address and length of the register sets for the device.
    maxItems: 1

  interrupts:
    description: the IRQ line for this Unicam instance.
    maxItems: 1

  clocks:
    description: |-
      list of clock specifiers, corresponding to entries in clock-names
      property.

  clock-names:
    items:
      - const: lp
      - const: vpu

  port:
    $ref: /schemas/graph.yaml#/properties/port

required:
  - compatible
  - reg
  - interrupts
  - clocks
  - clock-names
  - port

additionalProperties: False

examples:
  - |
    csi1: csi1@7e801000 {
        compatible = "brcm,bcm2835-unicam";
        reg = <0x7e801000 0x800>,
              <0x7e802004 0x4>;
        interrupts = <2 7>;
        clocks = <&clocks BCM2835_CLOCK_CAM1>,
                 <&firmware_clocks 4>;
        clock-names = "lp", "vpu";
        port {
                csi1_ep: endpoint {
                        remote-endpoint = <&tc358743_0>;
                        data-lanes = <1 2>;
                };
        };
    };

    i2c0: i2c@7e205000 {
        tc358743: csi-hdmi-bridge@0f {
            compatible = "toshiba,tc358743";
            reg = <0x0f>;
            clocks = <&tc358743_clk>;
            clock-names = "refclk";

            tc358743_clk: bridge-clk {
                    compatible = "fixed-clock";
                    #clock-cells = <0>;
                    clock-frequency = <27000000>;
            };

            port {
                    tc358743_0: endpoint {
                            remote-endpoint = <&csi1_ep>;
                            clock-lanes = <0>;
                            data-lanes = <1 2>;
                            clock-noncontinuous;
                            link-frequencies =
                                /bits/ 64 <297000000>;
                    };
            };
        };
    };
...
